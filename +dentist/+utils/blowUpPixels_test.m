dentist.tests.cleanupForTests;

im = [...
    0   1     0     0     0; ...
    0   0     2     3     0; ...
    0   0     0     0     0; ...
    0   0     0     0     0; ...
    0   0     0     0     100];

out = dentist.utils.blowUpPixels(im, 3, 'high');


expected = [...
    1   2     3     3     3; ...
    1   2     3     3     3; ...
    0   2     3     3     3; ...
    0   0     0     100     100; ...
    0   0     0     100     100];

assert(all(out(:) == expected(:)))

out = dentist.utils.blowUpPixels(im, 3, 'low');

expected = [...
    1       1       1       2       3; ...
    1       1       1       2       3; ...
    0       2       2       2   3; ...
    0       0       0       100     100; ...
    0       0       0       100     100];

assert(all(out(:) == expected(:)))

%% Dealing with 0 pixels that are actually signal.

im = [...
    0   1     0     0     0; ...
    0   0     2     3     0; ...
    0   0     0     0     0; ...
    0   0     0     0     0; ...
    0   0     0     0     100];

mask = [...
    0   1     0     0     0; ...
    0   0     1     1     0; ...
    0   0     0     1     0; ...
    0   0     0     0     0; ...
    0   0     0     0     1];

out = dentist.utils.blowUpPixels(im, 3, 'low', mask);

expected = [...
    1       1       1       2       3; ...
    1       1       0       0       0; ...
    0       2       0       0       0; ...
    0       0       0       0       0; ...
    0       0       0       100     100];
